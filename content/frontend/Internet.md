---
title: "Internet"
date: 2025-11-04
draft: false
---

## 网络工作原理

### 互联网是如何工作的
- 互联网的本质——一根电线
    - 核心：把数据从一台计算机传输到另一台计算机 
    - 工作原理 
        - 连接到互联网的计算机可以相互通信
            - 服务器——特殊计算机，可直接连接到互联网
            - 客户端通过ISP（互联网服务提供商）间接连接到互联网
        - 通过IP地址使计算机找到彼此
            - IP地址不方便记——>域名 
            - DNS服务器：域名——>IP地址
    - 数据包
        - 信息传输时（图片、邮件），计算机将信息分解为数据包进行传输
        - 并非所有数据包都需婧同意路径路由，数据包会独立选择最佳路径
    - 路由
        - 所有直接或间接连接到互联网的设备都有一个IP地址
        - 互联网交叉部分——路由器，引导数据包在互联网上传输
        - 客户端发送信息
            - 数据包第一层：电脑IP地址
            - 每经过一个路由器：添加该路由IP地址，直到服务器 
        - 服务器发送信息
            - 创建包装方式相同的数据包
            - 每经过一个路由器：解开该路由IP地址，直到电脑
    - 访问流程
        - 输入域名，浏览器向DNS发送，获取IP地址 
        - 浏览器将请求发送至相应服务器
        - 服务器收到请求，通过光纤电缆传输
    - 协议
        - 管理复杂数据包流
        - 数据包转换规则，路由规则等  

## 浏览器的工作原理
- 导航
    - 加载web界面的第一步
    - 发生在用户通过在地址栏输入一个 URL、点击一个链接、提交表单等
    - DNS查询 
        - 输入域名，浏览器向DNS发送，获取IP地址
        - 第一次请求之后，这个IP地址可能会被缓存一段时间，可从缓存中检索
    - TCP握手
        - 浏览器就会通过TCP“三次握手”与服务器建立连接
        - TCP 首先发送了三个消息进行协商，然后在两台电脑之间开始一个 TCP 会话
    - TLS协商
        - 对于通过HTTPS建立的安全连接，需要另一次 "握手"——TLS协商
- 响应
    - 建立与web服务器连接后，浏览器发送初始的HTTP GET请求（HTML文件）
    - 服务器使用响应头和HTML文件回复    
- 解析
    - 浏览器将通过网络接收的数据转换为DOM和CSSOM的步骤，通过渲染器在屏幕上将它们绘制成页面
    - 创建DOM树
        - 关键渲染路径的第一步是处理HTML标记并构造DOM树
        - 解析器将标记化的输入解析到文档中，构建文档树 
        - DOM树
            - <html>元素是第一个标签也是文档树的根节点
            - 嵌套在其他标记中的标记是子节点
            - DOM 节点的数量越多，构建 DOM 树所需的时间就越长
    - 预加载扫描器
        - 构建DOM树占据主线程
        - 在后台检索资源，当主HTML解析器解析到要请求的资源时，它们可能已经下载中了，或者已经被下载,减少了阻塞 
    - 构建CSSOM树
        - 关键渲染路径的第二步是处理 CSS 并构建CSSOM树
        - 浏览器将 CSS 规则转换为可以理解和使用的样式映射
        - DOM和CSSOM是两棵树 
    - 其他过程
        - Javascript编译
            - JavaScript 会被解析、编译和解释
            - 脚本被解析为抽象语法树
            - 将抽象语法树输入编译器，输出字节码 
        - 构建无障碍树
            - 辅助设备用于分析和解释内容 
- 渲染
    - 解析步骤中创建的 CSSOM 树和 DOM 树组合成一个渲染树 
    - 样式
        - 第三步是将 DOM 和 CSSOM 组合成渲染树
        - 计算样式树或渲染树的构建从DOM 树的根开始，遍历每个可见节点
        - 渲染树包含所有可见节点的内容和计算样式，将所有相关样式与DOM树中的每个可见节点匹配起来，并根据CSS级联，确定每个节点的计算样式 
    - 布局
        - 第四步是在渲染树上运行布局以计算每个节点的几何体 
        - 渲染树构建完毕后，浏览器就开始布局
        - 布局通常从body开始，设置所body后代的大小，同时给不知道其尺寸的替换元素提供占位符空间
        - 第一次确定每个节点的大小和位置称为布局，随后对节点大小和位置的重新计算称为重排
    - 绘制
        - 最后一步是将各个节点绘制到屏幕上
        - 浏览器将在布局阶段计算的每个盒子转换为屏幕上的实际像素，绘制涉及将元素的每个可见部分绘制到屏幕上
    - 合成
        - 当文档的各个部分以不同的层绘制，相互重叠时，必须进行合成    
    - 交互    

## DNS
### url
- 概述
    - URL（统一资源定位符）
    - 理论上说，每个有效的 URL 都指向一个唯一的资源
    - URL=方案+权威+资源路径+参数+锚点  
- 如何使用
    - 可以直接在浏览器的地址栏里输入任何 URL，来获得后台的资源 
 
### 域名
- 概述
    - 域名（Domain name）
    - 为互联网上任何可用的 Web 服务器提供了方便人类理解的地址
- 结构
    - TLD
        - TLD（Top-Level Domain，顶级域名）
        - 顶级域名的完整列表由ICANN维护 
    - 标签
        - 标签都是紧随着TLD的
        - 标签由1到63个大小写不敏感的字符组成
        - 刚好位于TLD前面的标签也被称为二级域名（SLD）     
### DNS解析
- 概述
    - 域名系统 (DNS) 
        - DNS是互联网电话簿
        - Web浏览器通过IP地址进行交互
        - DNS将域名转换为IP地址，以便浏览器能够加载互联网资源
- 工作流程
    - 加载网页涉及的四个DNS服务器
        - DNS解析器：接受客户端查询，发出请求
        - 根域名服务器：将人类可读的主机名解析为IP地址的第一步
        - TLD名称服务器：是搜索特定 IP 地址的下一步
        - 权威性域名服务器：域名服务器查询中的最后一站
    - 权威性DNS服务器与递归DNS解析器
        - 递归DNS解析器
            - 位于DNS查询开头
            - 响应来自客户端的递归请求并花时间追踪DNS记录
            - 递归DNS查询和递归DNS解析器
                - 递归DNS查询是指向需要解析该查询的DNS解析器发出的请求
                - DNS递归解析器是一种计算机，其接受递归查询并通过发出必要的请求来处理响应 
        - 权威性DNS服务器
            - 位于DNS查询末尾
            - 是实际持有并负责DNS资源记录的服务器  
    - 步骤
        - 用户在Web浏览器中键入 “example.com”，查询传输到互联网中，并被 DNS 递归解析器接收
        - 解析器查询DNS根域名服务器（.）
        - 根服务器使用存储其域信息的顶级域（TLD）DNS服务器（例如 .com 或 .net）的地址响应该解析器
        - 解析器向.com TLD发出请求
        - TLD服务器随后使用该域的域名服务器example.com的IP地址进行响应
        - 递归解析器将查询发送到域的域名服务器
        - example.com的IP地址而后从域名服务器返回解析器
        - DNS解析器使用最初请求的域的 IP 地址响应Web浏览器
        - 浏览器向该IP地址发出HTTP请求
        - 位于该IP的服务器返回将在浏览器中呈现的网页
    - 3种DNS查询类型
        - 递归查询
        - 迭代查询
        - 非递归查询        

## 云服务
- web服务器
    - 硬件部分
        - 存储了web服务器软件以及网站的组成文件
        - 接入到互联网并且支持与其他连接到互联网的设备进行物理数据的交互 
    - 软件部分 
        - 包括控制网络用户如何访问托管文件的几个部分，至少是一台HTTP服务器
        - HTTP服务器可理解URL与HTTP，可通过它所存储的网站域名进行访问 
    - 流程
        - 浏览器通过 HTTP 请求这个文件
        - 请求到达正确的web服务器（硬件），HTTP服务器（软件）收到这个请求
        - HTTP服务器找到这个被请求的文档，并把这个文档通过 HTTP 发送给浏览器
    - 静态/动态web浏览器
        - 静态
            - 静态web服务器=计算机（硬件）+HTTP 服务器（软件）
            - 这个服务器把它托管文件的“保持原样”地传送到你的浏览器 
        - 动态
            - 动态web服务器=应用服务器+数据库
            - 这个应用服务器会在通过 HTTP服务器把托管文件传送到你的浏览器之前会对这些托管文件进行更新   

## 网络代理
- 网络代理（Network Proxy）
    - 在客户端和目标服务器中间
    - 当访问一个网站时，请求不会直接发到目标服务器，而是先经过代理服务器，再由代理去访问目标，然后把结果返回 
- 工作流程
    - 浏览器输入网址，发出请求
    - 请求发送给代理服务器
    - 代理服务器访问目标服务器
    - 代理服务器把网页内容返回
- 用途
    - 隐私保护，隐藏真实IP
    - 帮助防止网络攻击
    - 绕过限制
    - 通过缓存或就近服务器加速响应
    - 在服务器端分配访问压力 
- 类型
    - 正向代理
        - 为客户端隐藏真实用户信息，代表客户端访问互联网上的其他服务器 
    - 反向代理
        - 为服务端提供身份保护和流量分发能力      